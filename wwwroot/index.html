<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>PowerShell Web Server</title>
    <link rel="icon" href="data:,">
</head> 

<body>

    <h1>Parameter Test</h1>

    <input type="text" name="p1" id="p1" value="Hello" />
    <input type="button" name="btnTest" value="Test Parameters" onclick="test();" /><br /><br />

    <h1>Login Test</h1>

    Username: <input type="text" name="username" id="username" value="admin"> <br />
    Password: <input type="password" name="password" id="password" value="admin"> <br />
    <br />

    <input type="button" name="btnLogin" value="Login Test" onclick="login();" />

    <br/>

    <h1>Exit</h1>

    <input type="button" name="btnExit" value="Exit Server" onclick="window.location.href='logout.html'" />

    <script type="text/javascript">

        function test() {
            var data = {
              "p1" : document.getElementById("p1").value
            }
            call_svc("/test", data, function (result) {
                alert(result.message);
            })
        }

        function login() {
            var data = {
                "username": document.getElementById("username").value,
                "password": document.getElementById("password").value,
                "test": [
                    { "a1": 1 },
                    { "a1": 2 },
                    { "a1": 3 }
                ]
            };
            call_svc("/login", data, function (result) {
                alert(result.message);
            })
        }

        function call_svc(url, data, callback, errCallback){
            fetch(url, {
              method: 'POST', // or 'PUT'
              headers: {
                'Content-Type': 'application/json',
              },
              body: JSON.stringify(data),
            })
            .then(response => response.json())
            .then(result => {
                if (result.status == "success") {
                    if (callback) { callback(result);}
                }
                else {
                    if (errCallback) {
                        errCallback(result);
                    }
                    else {
                        alert(result.message);
                    }
                }
            })
            .catch((error) => {
              console.error('Error:', error);
            });
        }

    </script>
</body>

</html>